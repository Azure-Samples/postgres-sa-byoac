# Azure Database for PostgreSQL - Flexible Server にジェネレーティブ AI を統合する

??? question "独自のデータを使用しますか？"

    独自の PostgreSQL データベースをソリューションアクセラレータに統合したい参加者のために、以下の手順をお勧めします：

    **1. 必要な拡張機能をインストールする**
    PostgreSQL データベースに必要な拡張機能がインストールされていることを確認してください：

    azure_ai: Azure AI サービスとの統合を容易にします。
    pgvector: ベクターデータの保存と類似検索を可能にします。
    pg_diskann: 効率的なベクターインデックスと検索機能を提供します。

    *注: pg_diskann 拡張機能はベクター拡張機能に依存しています。両方がインストールされていることを確認してください。*

    **2. 関連するテーブルを特定し、変更する**
    既存のデータベースで AI 生成データを保存するテーブルを特定します。これらのテーブルに対して：

    - ベクター列を追加する: 埋め込みを保存するためにベクター型の列を導入します。
    例:
    ``` sql
      ALTER TABLE your_table
      ADD COLUMN embedding vector(1536); -- モデルに応じて次元を調整
    ```
    - DiskANN インデックスを作成する: ベクター列をインデックス化してクエリ性能を向上させます。
    例:
    ```sql
      CREATE INDEX your_table_embedding_diskann_idx
      ON your_table
      USING diskann (embedding vector_cosine_ops);
    ```

    **3. マネージドアイデンティティと権限を設定する**
    以下の Azure サービスを設定します：

    - マネージドアイデンティティ: まだ設定されていない場合は、PostgreSQL サーバーにマネージドアイデンティティを割り当てます。
    - ロールの割り当て: 必要なデータアクセスを許可するために、関連する Azure Storage アカウントに対してマネージドアイデンティティに Storage Blob Data Contributor ロールを付与します。

    これらの手順を実施することで、既存の PostgreSQL データベースをソリューションアクセラレータにシームレスに統合し、効率的な AI 駆動のデータ処理と分析を可能にします。

ジェネレーティブ AI (GenAI) は、既存の情報から学習したパターンとデータに基づいて新しいオリジナルのコンテンツを作成するように設計された最先端の AI アルゴリズムのクラスを表します。自然言語処理 (NLP) はその重要な部分です。NLP により、ジェネレーティブ AI は人間の言語を理解し生成することができ、大量のテキストを要約したり、言語を翻訳したり、人と会話したりすることが可能になります。NLP を使用することで、ジェネレーティブ AI は自然に聞こえ、文脈に合ったコンテンツを作成することができます。プロンプトやリトリーバル強化生成 (RAG) などの技術を用いることで、GenAI はテキストや画像などの革新的な出力を生成することができます。

Azure Database for PostgreSQL - Flexible Server における生成AI（GenAI）の組み込みは、Azure AI (`azure_ai`) および pgvector (`vector`) 拡張機能を通じて実現されます。`azure_ai` 拡張機能は、大規模言語モデル（LLM）をデータベース内に直接統合し、Azure OpenAI や Azure Cognitive Services などの Azure の高度な AI サービスとのシームレスな連携を提供します。これらの統合により、強力な AI 機能をデータベースインフラストラクチャに直接組み込むことで、アプリケーションを向上させることができます。`vector` 拡張機能は `azure_ai` 拡張機能と連携し、データベースクエリ内でベクトル埋め込みを生成し、それをデータベースに保存およびクエリすることができます。また、強力なベクトル類似性検索機能も可能にします。

さらに、`pg_diskann` 拡張機能は、効率的なベクトルインデックス作成と検索のための DiskANN サポートを有効にします。DiskANN は、任意のスケールで効率的なベクトル検索を行うためのスケーラブルな近似最近傍検索アルゴリズムです。これは、高いリコール、高いクエリ毎秒、および低いクエリ遅延を提供し、数十億ポイントのデータセットでも効果的です。

このセクションでは、拡張機能を使用して PostgreSQL データベースを生成AIおよびベクトル検索機能で強化します。以下のことを達成します：

- [ ] PostgreSQL データベースに `azure_ai`、`pg_diskann`、および `vector` 拡張機能をインストールする
- [ ] Azure AI サービスの接続詳細で `azure_ai` 拡張機能を構成する
- [ ] ベクトル列をデータベーステーブルに追加し、テキストデータと共に埋め込みを保存できるようにする
- [ ] DiskANN を使用してベクトルクエリのパフォーマンスを向上させる
- [ ] 既存データの埋め込みを生成して保存する

これらの手順に従うことで、PostgreSQL データベースを強力な AI 強化プラットフォームに変え、高度な生成AIタスクを実行し、データからより深い洞察を提供できるようになります。
